<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="/static/css/index.css" />
    <link rel="stylesheet" href="/static/css/body.css" />
    <link rel="stylesheet" href="/static/css/train-form.css" />
    <title>Đăng nhập quản trị - Hệ thống chấm công TLU</title>
  </head>
  <body>
    <video autoplay muted loop plays-inline>
      <source src="/static/videos/bg.mp4" type="video/mp4" />
    </video>

    <header>
      <img src="/static/images/icon.png" alt="Icon" />
    </header>

    <main>
      <section class="left-section">
        <h1>Quản trị</h1>
        <p id="description">Đăng nhập để tiếp tục</p>
      </section>

      <div class="wrapper">
        <form id="admin-login-form">
          <h2>Đăng nhập</h2>
          <div class="input-field">
            <input type="text" required id="username" name="username" />
            <label>Tài khoản</label>
          </div>
          <div class="input-field">
            <input type="password" required id="password" name="password" />
            <label>Mật khẩu</label>
          </div>
          <div id="login-error" class="error-message"></div>
          <button id="login-button" type="submit">Đăng nhập</button>
        </form>
      </div>

      <section class="right-section">
        <a href="/">
          <div class="button">
            Chấm công
            <p>Quay về mục chấm công</p>
          </div>
        </a>
      </section>
    </main>

    <footer>
      <h3>Luccihank x HieuCaoTlu</h3>
    </footer>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const loginForm = document.getElementById('admin-login-form');
        const loginError = document.getElementById('login-error');
        
        loginForm.addEventListener('submit', async function(e) {
          e.preventDefault();
          
          const username = document.getElementById('username').value;
          const password = document.getElementById('password').value;
          
          try {
            const formData = new FormData();
            formData.append('username', username);
            formData.append('password', password);
            
            const response = await fetch('/login', {
              method: 'POST',
              body: formData
            });
            
            const result = await response.json();
            
            if (result.success) {
              // Đăng nhập thành công, chuyển hướng đến trang admin
              window.location.href = '/admin';
            } else {
              // Hiển thị thông báo lỗi
              loginError.textContent = result.message || 'Đăng nhập thất bại. Vui lòng thử lại.';
            }
          } catch (error) {
            console.error('Lỗi đăng nhập:', error);
            loginError.textContent = 'Đã xảy ra lỗi khi đăng nhập. Vui lòng thử lại.';
          }
        });
      });
    </script>
  </body>
</html> 